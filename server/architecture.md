# Архитектура приложения

Общий документ для описания архитектуры

## Компоненты приложения:

text

### observer

_dir_ src

_file_ "castomTread.py":

- _fn_ MyThread:
  - **описание**: код реализующий доступ к потоку
  - **принимает**: arg*
  - **функции**:
    - stop: останавливает поток
    - stopped: возвращает true, если поток был остановлен
  - **возвращает**: управление потоком

---

_file_ "fetchInfo.py":

- _fn_ fetch_change_room_data
  - **описание**: подготовка данных из библиотеки в бд
  - **принимает**: member, before, after
  - **делает**: подготавливает данные для записи к бд
  - **возвращает**: подготовленный объект

---

_file_ "schemes.py:

- _описание_: Нужен для описания таблицы в бд
- _class_ ActionClass(Base) - описание 1
- _class_ ActionTableClass(Base) - описание 2

---

_file_ "dbModule.py":

- _class_ createConnect:
  - **описание**: класс для ввода данных в бд (конкретики бд нет)
  - **принимает** connect_args
  - **функции**:
    - write_action
      - **принимает**: dict: данные для записи
      - **делает**: подготавливает и записывает полученные данные в бд

---

_file_ "Observer.py":

- _class_ Observer:
  - **описание**: большой класс для объявления инструкций для событий
  - **принимает**:
  - connect_args,
  - ignor_list: лист с id,
  - target_list: лист с id
  - **функции**:
    - run:
      - **принимает**: token - токен для запуска
      - **делает**:
        - запускает обсервер
        - создает соединение через _createConnect_ к бд:
        - создает обработчик событий
  - _@_ on_voice_state_update: записывает в базу данных полученные данные

### processMenadjer

processMenadjer - объект для организации доступа к имеющимся потокам

- treads - список с объектами:

``` python
{
  'id': int,
  'name': str,
  'process': fn(),
  ...
}
```

- _fn_ create:
  - **описание**: функция создания нового потока с наблюдателем
  - **принимает** id, name
  - **делает** Запускает **observer** в отдельном потоке и объект в списке treads через **MyThread**
  - **возвращвет** id нового потока

- _fn_ delite
  - **описание**: функция удаления потока
  - **принимает** id
  - **делает** Удаляет объект и останавливает поток
  _ **возвращвет** true false

- _fn_ status
  - **описание**: функция получения статуса поток(а/ов)
  - **возвращвет** статус всех потоков  

### Серверные fn

файл: server.py

REST API со следующими функциями и объектами

- _@_ status **get**
  - **возвращвет**: статус всех объектов  

- _@_ create **post**
  - **принимает**: env, name
  - **возвращвет**: id

- _@_ delite **post**
  - **принимает**: id
  - **возвращвет**: true/false
